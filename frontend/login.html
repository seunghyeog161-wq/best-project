<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¡œê·¸ì¸ í˜ì´ì§€</title>
  <style>
    body {
      background: linear-gradient(to bottom right, #e8f0ff, #f0f4ff);
      font-family: 'Arial', sans-serif;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .login-box {
      background-color: #fff;
      padding: 40px 30px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
      text-align: center;
      width: 360px;
    }

    h2 {
      margin-bottom: 10px;
      font-size: 24px;
      color: #222;
    }

    p {
      color: #555;
      margin-bottom: 20px;
      font-size: 14px;
    }

    .btn {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn img {
      width: 20px;
      height: 20px;
    }

    .google { background: #ffffff; border: 1px solid #ccc; }
    .google:hover { background: #f1f1f1; }

    .facebook { background: #1877f2; color: white; }
    .facebook:hover { background: #145dc2; }

    .instagram { background: linear-gradient(to right, #833ab4, #fd1d1d, #fcb045); color: white; }
    .instagram:hover { filter: brightness(1.1); }

    .naver { background: #03C75A; color: white; }
    .naver:hover { background: #029c46; }

    .divider {
      margin: 20px 0;
      position: relative;
      text-align: center;
    }
    .divider::before, .divider::after {
      content: "";
      position: absolute;
      top: 50%;
      width: 40%;
      height: 1px;
      background: #ccc;
    }
    .divider::before { left: 0; }
    .divider::after { right: 0; }
    .divider span {
      padding: 0 10px;
      background: #fff;
      color: #999;
      font-size: 12px;
    }

    .create-btn {
      padding: 12px;
      width: 100%;
      border-radius: 8px;
      border: 1px solid #ccc;
      background: #f9f9f9;
      font-size: 16px;
      cursor: pointer;
      margin: 10px 0;
    }
    #login-btn {
      margin-bottom: 16px; /* ë¡œê·¸ì¸í•˜ê¸° â†” ìƒˆ ê³„ì • ë§Œë“¤ê¸° ì‚¬ì´ ì—¬ë°± (0.5cm) */
    }
    .create-btn:hover {
      background: #f1f1f1;
    }

    .footer {
      margin-top: 20px;
      font-size: 13px;
      color: #666;
    }

    /* í†±ë‹ˆë°”í€´ + ë“œë¡­ë‹¤ìš´ */
    .settings {
      position: absolute;
      top: 16px;
      right: 16px;
    }
    .settings button {
      background: none;
      border: none;
      cursor: pointer;
      font-size: 22px;
    }
    .dropdown {
      display: none;
      position: absolute;
      top: 36px;
      right: 0;
      background: #fff;
      border: 1px solid #ccc;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      width: 120px;
    }
    .dropdown a {
      display: block;
      padding: 10px;
      color: #333;
      text-decoration: none;
      font-size: 14px;
    }
    .dropdown a:hover {
      background: #f5f5f5;
    }
    button, a { touch-action: manipulation; -webkit-tap-highlight-color: transparent; }
    .btn { user-select: none; }
    /* --- Toast --- */
    #toast {
      position: fixed;
      left: 50%;
      bottom: 24px;
      transform: translateX(-50%);
      min-width: 240px;
      max-width: 90vw;
      padding: 12px 16px;
      background: rgba(0,0,0,0.85);
      color: #fff;
      border-radius: 10px;
      font-size: 14px;
      text-align: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity .25s ease;
      z-index: 9999;
    }
    #toast.show { opacity: 1; }

  </style>
</head>
<div id="toast" aria-live="polite" aria-atomic="true"></div>
<body>
  
  <!-- í†±ë‹ˆë°”í€´ ì„¤ì • -->
  <div class="settings">
    <button id="settings-btn">âš™ï¸</button>
    <div class="dropdown" id="settings-menu">
      <a href="#">ë¬¸ì˜</a>
    </div>
  </div>
  <!-- ğŸ”» ê³„ì • ì…ë ¥ í¼ (ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€) -->
  <div id="form-box" style="display: none; margin-top: 20px;">
    <input type="text" id="name" placeholder="ì´ë¦„" style="width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #ccc; display: none;" />

    <input type="email" id="email" placeholder="ì´ë©”ì¼" style="width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #ccc;" />

    <input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸" style="width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #ccc;" />

    <input type="password" id="password2" placeholder="ë¹„ë°€ë²ˆí˜¸ í™•ì¸" style="width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 6px; border: 1px solid #ccc; display: none;" />
  </div>


  <!-- ë¡œê·¸ì¸ ë°•ìŠ¤ -->
  <div class="login-box">
    <h2>í™˜ì˜í•©ë‹ˆë‹¤</h2>
    <p>ì†Œì…œ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ê±°ë‚˜ ìƒˆ ê³„ì •ì„ ë§Œë“œì„¸ìš”</p>

    <button class="btn google" id="google-btn">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/google/google-original.svg" alt="Google Logo" />
      Googleìœ¼ë¡œ ê³„ì†í•˜ê¸°
    </button>

    <button class="btn facebook">
      <img src="https://cdn.jsdelivr.net/gh/devicons/devicon/icons/facebook/facebook-original.svg" alt="Facebook Logo" />
      Facebookìœ¼ë¡œ ê³„ì†í•˜ê¸°
    </button>

    <button class="btn instagram">
      <img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/Instagram_icon.png" alt="Instagram Logo" />
      Instagramìœ¼ë¡œ ê³„ì†í•˜ê¸°
    </button>

    <button class="btn naver" id="naver-btn">
      <img src="https://static.nid.naver.com/oauth/small_g_in.PNG" alt="Naver Logo" />
      Naverë¡œ ê³„ì†í•˜ê¸°
    </button>

    <div class="divider"><span>ë˜ëŠ”</span></div>

    <button class="create-btn" id="login-btn">ë¡œê·¸ì¸í•˜ê¸°</button>
    <button class="create-btn" id="signup-btn">ìƒˆ ê³„ì • ë§Œë“¤ê¸°</button>

    <div class="footer">
      ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”? ìœ„ì˜ ì†Œì…œ ë¡œê·¸ì¸ ë²„íŠ¼ì„ ì‚¬ìš©í•˜ì„¸ìš”
    </div>
  </div>

<!-- â†“â†“â†“ ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ </body> ë°”ë¡œ ìœ„ì— ë¶™ì—¬ ë„£ê¸° â†“â†“â†“ -->
<script>
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (A) í†±ë‹ˆë°”í€´ ë“œë¡­ë‹¤ìš´
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const settingsBtn  = document.getElementById('settings-btn');
  const settingsMenu = document.getElementById('settings-menu');

  settingsBtn?.addEventListener('click', () => {
    settingsMenu.style.display = (settingsMenu.style.display === 'block') ? 'none' : 'block';
  });
  document.addEventListener('click', (e) => {
    if (!settingsBtn.contains(e.target) && !settingsMenu.contains(e.target)) {
      settingsMenu.style.display = 'none';
    }
  });

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (B) ìœ í‹¸: í† ìŠ¤íŠ¸ (CSS/DOM ìë™ ì£¼ì…)
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  (function injectToast(){
    if (document.getElementById('toast')) return;
    const style = document.createElement('style');
    style.textContent = `
      #toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%);
      min-width:240px;max-width:90vw;padding:12px 16px;background:rgba(0,0,0,.85);
      color:#fff;border-radius:10px;font-size:14px;text-align:center;opacity:0;
      pointer-events:none;transition:opacity .25s ease;z-index:9999}
      #toast.show{opacity:1}
    `;
    document.head.appendChild(style);
    const box = document.createElement('div');
    box.id = 'toast';
    box.setAttribute('aria-live','polite');
    box.setAttribute('aria-atomic','true');
    document.body.appendChild(box);
  })();

  function toast(msg, ms=1800){
    const box = document.getElementById('toast');
    if (!box) return alert(msg);
    box.textContent = msg;
    box.classList.add('show');
    setTimeout(()=>box.classList.remove('show'), ms);
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (C) ê³µí†µ fetch í—¬í¼ (ì¿ í‚¤ í¬í•¨: refresh í† í° ìœ„í•´)
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function api(path, method='GET', body=null, useAuth=false){
    const headers = {'Content-Type':'application/json'};
    if (useAuth) {
      const t = localStorage.getItem('access_token');
      if (t) headers['Authorization'] = 'Bearer ' + t;
    }
    const res = await fetch(path, {
      method, headers,
      body: body ? JSON.stringify(body) : undefined,
      credentials: 'include'
    });
    const data = await res.json().catch(()=> ({}));
    if (!res.ok) throw new Error(data.detail || `ìš”ì²­ ì‹¤íŒ¨ (${res.status})`);
    return data;
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (D) ìš”ì†Œ ì°¸ì¡° + ëª¨ë“œ ê´€ë¦¬
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const formBox   = document.getElementById('form-box');
  const inputName = document.getElementById('name');
  const inputEmail= document.getElementById('email');
  const inputPw   = document.getElementById('password');
  const inputPw2  = document.getElementById('password2');

  const loginBtn  = document.getElementById('login-btn');
  const signupBtn = document.getElementById('signup-btn');

  let mode = 'login'; // 'login' | 'signup'

  function setMode(next){
    mode = next;
    formBox.style.display = 'block';
    if (mode === 'login'){
      inputName.style.display = 'none';
      inputPw2.style.display  = 'none';
      loginBtn.style.background  = '#dfefff';
      signupBtn.style.background = '';
    } else {
      inputName.style.display = 'block';
      inputPw2.style.display  = 'block';
      signupBtn.style.background = '#dfefff';
      loginBtn.style.background  = '';
    }
  }

  // ì´ˆê¸°ì—ëŠ” í¼ ìˆ¨ê¹€(HTMLì—ì„œ display:noneì´ë¼ë©´ ê·¸ëŒ€ë¡œ ìœ ì§€)
  // setMode('login'); // í•„ìš” ì‹œ ê¸°ë³¸ ëª¨ë“œ ì§€ì •

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (E) ì†Œì…œ ë¡œê·¸ì¸ ë²„íŠ¼ ì—°ê²° (ê·¸ëŒ€ë¡œ ìœ ì§€)
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  document.getElementById('google-btn')?.addEventListener('click', () => {
    location.href = 'https://myproject-ai1.vercel.app/auth/google/login';// '/auth/google'ë„ ë™ì‘í•˜ì§€ë§Œ, ì¼ê´€ë˜ê²Œ /login ì‚¬ìš©
  });
  document.querySelector('.btn.facebook')?.addEventListener('click', () => {
    location.href = 'https://myproject-ai1.vercel.app/auth/facebook/login';
  });
  document.querySelector('.btn.instagram')?.addEventListener('click', () => {
    toast('Instagram ë¡œê·¸ì¸ì€ ì¤€ë¹„ ì¤‘ì…ë‹ˆë‹¤.\n(í˜ì´ìŠ¤ë¶/ë„¤ì´ë²„ë¥¼ ë¨¼ì € ì´ìš©í•´ ì£¼ì„¸ìš”)');
  });
  document.getElementById('naver-btn')?.addEventListener('click', () => {
    location.href = 'https://myproject-ai1.vercel.app/auth/naver/login';
  });

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (F) ë¡œê·¸ì¸ ë²„íŠ¼: â‘ ì²« í´ë¦­=ëª¨ë“œì „í™˜/í¼í‘œì‹œ â‘¡ë‘ë²ˆì§¸ í´ë¦­=ì‹¤í–‰
  //  - ì…ë ¥ê°’ì´ ìˆìœ¼ë©´ ì´ë©”ì¼/ë¹„ë²ˆ ë¡œê·¸ì¸
  //  - ì…ë ¥ê°’ì´ ì—†ìœ¼ë©´ access_token ë˜ëŠ” refresh ì‹œë„ í›„ /auth/me
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let loginBusy = false;
  loginBtn?.addEventListener('click', async () => {
    if (loginBusy) return;
    if (formBox.style.display === 'none' || mode !== 'login') {
      setMode('login');
      return;
    }

    loginBusy = true;
    loginBtn.disabled = true;

    try {
      const email = inputEmail?.value.trim();
      const pw = inputPw?.value;

      if (email && pw){
        const r = await api('/auth/login', 'POST', { email, password: pw });
        localStorage.setItem('access_token', r.access_token);
        toast('ë¡œê·¸ì¸ ì„±ê³µ!');
        location.href = 'https://myproject-ai1.vercel.app/login2.html'; // ìˆ˜ì •
      } else {
        let token = localStorage.getItem('access_token');
        if (!token) {
          try {
            const r = await api('https://myproject-ai1.vercel.app/auth/refresh', 'POST');
            localStorage.setItem('access_token', r.access_token);
            token = r.access_token;
          } catch (_) {
            toast('ì†Œì…œ ë¡œê·¸ì¸ ë²„íŠ¼ìœ¼ë¡œ ë¨¼ì € ë¡œê·¸ì¸í•´ ì£¼ì„¸ìš”.');
            return;
          }
        }
        const me = await api('https://myproject-ai1.vercel.app/auth/me', 'GET', null, true);
        toast(`í™˜ì˜í•©ë‹ˆë‹¤, ${me.name ?? me.email}ë‹˜!`);
        location.href = 'https://myproject-ai1.vercel.app/login2.html'; ìˆ˜ì •
      }
    } catch (e) {
      toast(e.message || 'ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      loginBusy = false;
      loginBtn.disabled = false;
    }
  });

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (G) íšŒì›ê°€ì… ë²„íŠ¼: â‘ ì²« í´ë¦­=ëª¨ë“œì „í™˜/í¼í‘œì‹œ â‘¡ë‘ë²ˆì§¸ í´ë¦­=ì‹¤í–‰
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  let signupBusy = false;
  signupBtn?.addEventListener('click', async () => {
    if (signupBusy) return;
    if (formBox.style.display === 'none' || mode !== 'signup') {
      setMode('signup');
      return;
    }

    signupBusy = true;
    signupBtn.disabled = true;

    try {
      const email = inputEmail?.value.trim();
      const pw = inputPw?.value;
      const pw2 = inputPw2?.value;
      const name = inputName?.value.trim();

      if (!name || !email || !pw || !pw2) { toast('ëª¨ë“  ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”.'); return; }
      if (pw.length < 8) { toast('ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.'); return; }
      if (pw !== pw2) { toast('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'); return; }

      await api('https://myproject-ai1.vercel.app/auth/register', 'POST', { email, password: pw, name: name || null });

      toast('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');

      // ìë™ ë¡œê·¸ì¸
      const { access_token } = await api('/auth/login', 'POST', { email, password: pw });
      localStorage.setItem('access_token', access_token);
      toast('ìë™ ë¡œê·¸ì¸ ì™„ë£Œ!');
      location.href = 'https://myproject-ai1.vercel.app/login2.html';// ìˆ˜ì •
    } catch (e) {
      toast(e.message || 'íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
    } finally {
      signupBusy = false;
      signupBtn.disabled = false;
    }
  });

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // (H) ë”ë¸”í´ë¦­/ì¤‘ë³µ ë¦¬ìŠ¤ë„ˆ ì œê±° (ê¸°ì¡´ ì½”ë“œ ëŒ€ì²´)
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // â€» ì˜ë„ì ìœ¼ë¡œ ë”ë¸”í´ë¦­ ë“±ë¡ ë¡œì§ì€ ì‚¬ìš©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
  </script>
